app:
  name: app
  port: 8080
  metricsPort: 9090
  replicas: 2
  image: "ghcr.io/doda2025-team21/app"

  tag: "0.2.1"      # Stable version tag (use actual available tag from your registry)
  canaryTag: "0.2.1" # Canary version tag - with new UI design

  service:
    type: ClusterIP
    nodePort: "" # only used when type is NodePort or LoadBalancer
  ingress:
    className: nginx
    hosts:
      stable: sms.local
      preview: ""  

model:
  name: model-service
  port: 8081
  metricsPort: 9091
  image: "ghcr.io/doda2025-team21/model-service"
  tag: "1.0.5"

# Prometheus monitoring configuration
prometheus:
  enabled: true
  scrapeInterval: "15s"
  scrapeTimeout: "10s"

# kube-prometheus-stack subchart configuration
kube-prometheus-stack:
  alertmanager:
    enabled: false
  grafana:
    enabled: true
    adminPassword: "admin"
    ingress:
      enabled: true
      ingressClassName: nginx
      hosts:
        - grafana.local
  prometheus:
    prometheusSpec:
      serviceMonitorSelectorNilUsesHelmValues: false
      serviceMonitorSelector: {}
      serviceMonitorNamespaceSelector: {}
      resources:
        requests:
          memory: 400Mi
        limits:
          memory: 800Mi
  kubeApiServer:
    enabled: false
  kubeControllerManager:
    enabled: false
  kubeScheduler:
    enabled: false
  kubeProxy:
    enabled: false
  kubeEtcd:
    enabled: false
  nodeExporter:
    enabled: true
  prometheusOperator:
    enabled: true

# Istio traffic management configuration
istio:
  enabled: true
  # Ingress gateway configuration - make this configurable for other clusters
  # The selector label value used by the gateway (matches the 'istio' label on the ingress gateway pod)
  # Default Istio installations use 'ingressgateway' as the label value: istio=ingressgateway
  ingressGateway:
    # Selector value for 'istio' label on the ingress gateway pod
    selector: ingressgateway
    # Namespace where ingress gateway is deployed
    namespace: istio-system
  # Host for accessing the app via Istio
  host: sms-istio.local
  # Canary release configuration
  canary:
    enabled: true
    # Percentage of traffic to canary (0-100)
    weight: 10
    # Header-based routing for testing
    headerName: x-canary
    headerValue: "true"
  # Sticky session configuration
  stickySession:
    enabled: true
    # Cookie name for session affinity
    cookieName: "sms-session"
    ttl: 3600s
